<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Stimulus with Tailwind</title>

    <!-- Tailwind CSS via Play CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Import Maps for Stimulus -->
    <script type="importmap">
      {
        "imports": {
          "@hotwired/stimulus": "https://unpkg.com/@hotwired/stimulus/dist/stimulus.js"
        }
      }
    </script>
  </head>
  <body class="bg-gray-100 min-h-screen py-8">
    <div class="container mx-auto px-4">
      <div class="max-w-2xl mx-auto space-y-6">
        <h1 class="text-3xl font-bold text-gray-800 text-center mb-8">Stimulus Data Binding Examples</h1>

        <!-- 1. Counter Example -->
        <div class="bg-white rounded-lg shadow-md p-6 space-y-4">
          <h2 class="text-xl font-semibold text-gray-700">1. Counter with Conditional Styling</h2>
          <div class="flex gap-3" data-controller="binding" data-binding-initial-state="{ count: 0 }">
            <button
              data-action="click->binding#updateState"
              data-binding-updater-param="state.count--"
              class="bg-blue-500 text-white rounded p-2 w-12 hover:bg-blue-600"
            >
              -
            </button>
            <div
              class="flex-1 text-center p-2 bg-gray-100 rounded font-medium"
              data-binding-text="state.count"
              data-binding-class="{ '!bg-red-100': state.count < 0, '!bg-green-100': state.count > 10 }"
            >
              0
            </div>
            <button
              data-action="click->binding#updateState"
              data-binding-updater-param="state.count++"
              class="bg-blue-500 text-white rounded p-2 w-12 hover:bg-blue-600"
            >
              +
            </button>
          </div>
        </div>

        <!-- 2. Text Input Example -->
        <div class="bg-white rounded-lg shadow-md p-6 space-y-4">
          <h2 class="text-xl font-semibold text-gray-700">2. Text Input with Dynamic Styling</h2>
          <div class="flex gap-3" data-controller="binding" data-binding-initial-state="{ message: 'hello' }">
            <input
              type="text"
              data-binding-value="state.message"
              data-binding-class="{ 'bg-green-100': state.message === 'hello' }"
              class="flex-1 p-2 border border-gray-300 rounded"
              data-action="input->binding#updateState"
              data-binding-updater-param="state.message = target.value"
            />
            <button
              data-action="click->binding#updateState"
              data-binding-updater-param="state.message = ''"
              class="bg-blue-500 text-white rounded p-2 hover:bg-blue-600"
            >
              Clear
            </button>
            <button
              data-action="click->binding#updateState"
              data-binding-updater-param="state.message = 'hello'"
              class="bg-blue-500 text-white rounded p-2 hover:bg-blue-600"
            >
              Reset
            </button>
          </div>
        </div>

        <!-- 3. Progress Bar Example -->
        <div class="bg-white rounded-lg shadow-md p-6 space-y-4">
          <h2 class="text-xl font-semibold text-gray-700">3. Progress Bar with Status</h2>
          <div data-controller="binding" data-binding-initial-state="{ progress: 25 }">
            <!-- Computed Properties Templates -->
            <script type="text/template" data-binding-computed="progressColor">
              ({ 'text-red-600': state.progress < 30, 'text-yellow-600': state.progress >= 30 && state.progress < 70, 'text-green-600':
                            state.progress >= 70 })
            </script>
            <script type="text/template" data-binding-computed="progressBarColor">
              ({ 'bg-red-600': state.progress < 30, 'bg-yellow-600': state.progress >= 30 && state.progress < 70, 'bg-green-600':
                            state.progress >= 70 })
            </script>
            <script type="text/template" data-binding-computed="progressText">
              state.progress + '%'
            </script>
            <script type="text/template" data-binding-computed="progressStyle">
              ({ width: state.progress + '%' })
            </script>
            <script type="text/template" data-binding-computed="canDecrease">
              state.progress > 0
            </script>
            <script type="text/template" data-binding-computed="canIncrease">
              state.progress < 100
            </script>

            <div class="flex justify-between items-center mb-2">
              <span class="text-sm font-medium text-gray-700">Progress:</span>
              <span data-binding-text="computed.progressText" data-binding-class="computed.progressColor" class="text-sm font-bold">
                25%
              </span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-4 mb-4">
              <div
                data-binding-class="computed.progressBarColor"
                class="h-4 rounded-full transition-all duration-300"
                data-binding-style="computed.progressStyle"
              ></div>
            </div>
            <div class="flex gap-2">
              <button
                data-action="click->binding#updateState"
                data-binding-updater-param="state.progress = Math.max(0, state.progress - 10)"
                data-binding-disabled="!computed.canDecrease"
                class="bg-red-500 text-white hover:bg-red-600 disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed px-3 py-1 rounded text-sm transition-colors"
              >
                -10%
              </button>
              <button
                data-action="click->binding#updateState"
                data-binding-updater-param="state.progress = Math.min(100, state.progress + 10)"
                data-binding-disabled="!computed.canIncrease"
                class="bg-green-500 text-white hover:bg-green-600 disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed px-3 py-1 rounded text-sm transition-colors"
              >
                +10%
              </button>
              <button
                data-action="click->binding#updateState"
                data-binding-updater-param="state.progress = 25"
                class="bg-gray-500 text-white px-3 py-1 rounded text-sm hover:bg-gray-600"
              >
                Reset
              </button>
            </div>
          </div>
        </div>

        <!-- 4. Shopping Cart Example -->
        <div class="bg-white rounded-lg shadow-md p-6 space-y-4">
          <h2 class="text-xl font-semibold text-gray-700">4. Shopping Cart Calculator</h2>
          <div data-controller="binding" data-binding-initial-state="{ quantity: 1, price: 29.99, discount: 0 }">
            <!-- Computed Properties Templates -->
            <script type="text/template" data-binding-computed="subtotal">
              state.quantity * state.price
            </script>
            <script type="text/template" data-binding-computed="discountAmount">
              computed.subtotal * state.discount / 100
            </script>
            <script type="text/template" data-binding-computed="total">
              computed.subtotal - computed.discountAmount
            </script>

            <div class="grid grid-cols-2 gap-4 mb-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Quantity</label>
                <input
                  type="number"
                  min="1"
                  data-binding-value="state.quantity"
                  data-action="input->binding#updateState"
                  data-binding-updater-param="state.quantity = Math.max(1, parseInt(target.value) || 1)"
                  class="w-full p-2 border border-gray-300 rounded"
                />
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Price per item</label>
                <input
                  type="number"
                  step="0.01"
                  min="0"
                  data-binding-value="state.price"
                  data-action="input->binding#updateState"
                  data-binding-updater-param="state.price = Math.max(0, parseFloat(target.value) || 0)"
                  class="w-full p-2 border border-gray-300 rounded"
                />
              </div>
            </div>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700 mb-1">Discount (%)</label>
              <input
                type="range"
                min="0"
                max="50"
                data-binding-value="state.discount"
                data-action="input->binding#updateState"
                data-binding-updater-param="state.discount = parseInt(target.value)"
                class="w-full"
              />
              <div class="text-center text-sm text-gray-600 mt-1" data-binding-text="state.discount + '% off'">0% off</div>
            </div>
            <div class="bg-gray-50 p-4 rounded">
              <div class="flex justify-between items-center text-sm text-gray-600 mb-1">
                <span>Subtotal:</span>
                <span data-binding-text="'$' + computed.subtotal.toFixed(2)">$29.99</span>
              </div>
              <div class="flex justify-between items-center text-sm text-gray-600 mb-1">
                <span>Discount:</span>
                <span data-binding-text="'-$' + computed.discountAmount.toFixed(2)">-$0.00</span>
              </div>
              <div class="flex justify-between items-center text-lg font-bold text-gray-800 border-t pt-2">
                <span>Total:</span>
                <span data-binding-text="'$' + computed.total.toFixed(2)">$29.99</span>
              </div>
            </div>
          </div>
        </div>

        <!-- 5. Theme Switcher Example -->
        <div class="bg-white rounded-lg shadow-md p-6 space-y-4">
          <h2 class="text-xl font-semibold text-gray-700">5. Theme Switcher</h2>
          <div data-controller="binding" data-binding-initial-state="{ theme: 'light', fontSize: 'medium' }">
            <!-- Computed Properties Templates -->
            <script type="text/template" data-binding-computed="isLightTheme">
              state.theme === 'light'
            </script>
            <script type="text/template" data-binding-computed="isDarkTheme">
              state.theme === 'dark'
            </script>
            <script type="text/template" data-binding-computed="isColorfulTheme">
              state.theme === 'colorful'
            </script>
            <script type="text/template" data-binding-computed="isSmallFont">
              state.fontSize === 'small'
            </script>
            <script type="text/template" data-binding-computed="isMediumFont">
              state.fontSize === 'medium'
            </script>
            <script type="text/template" data-binding-computed="isLargeFont">
              state.fontSize === 'large'
            </script>
            <script type="text/template" data-binding-computed="previewClasses">
              ({ 'bg-white text-gray-800 border': computed.isLightTheme, 'bg-gray-800 border-gray-600 text-gray-100': computed.isDarkTheme,
                            'bg-gradient-to-r from-purple-400 via-pink-500 to-red-500 text-white': computed.isColorfulTheme, 'text-sm':
                            computed.isSmallFont, 'text-base': computed.isMediumFont, 'text-lg': computed.isLargeFont })
            </script>
            <script type="text/template" data-binding-computed="themeText">
              state.theme + ' theme'
            </script>
            <script type="text/template" data-binding-computed="fontText">
              state.fontSize + ' font'
            </script>

            <div class="grid grid-cols-2 gap-4 mb-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Theme</label>
                <div class="space-y-2">
                  <label class="flex items-center">
                    <input
                      type="radio"
                      name="theme"
                      value="light"
                      data-action="change->binding#updateState"
                      data-binding-updater-param="state.theme = target.value"
                      data-binding-checked="computed.isLightTheme"
                      class="mr-2"
                      checked
                    />
                    Light
                  </label>
                  <label class="flex items-center">
                    <input
                      type="radio"
                      name="theme"
                      value="dark"
                      data-action="change->binding#updateState"
                      data-binding-updater-param="state.theme = target.value"
                      data-binding-checked="computed.isDarkTheme"
                      class="mr-2"
                    />
                    Dark
                  </label>
                  <label class="flex items-center">
                    <input
                      type="radio"
                      name="theme"
                      value="colorful"
                      data-action="change->binding#updateState"
                      data-binding-updater-param="state.theme = target.value"
                      data-binding-checked="computed.isColorfulTheme"
                      class="mr-2"
                    />
                    Colorful
                  </label>
                </div>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Font Size</label>
                <select
                  data-binding-value="state.fontSize"
                  data-action="change->binding#updateState"
                  data-binding-updater-param="state.fontSize = target.value"
                  class="w-full p-2 border border-gray-300 rounded"
                >
                  <option value="small">Small</option>
                  <option value="medium" selected>Medium</option>
                  <option value="large">Large</option>
                </select>
              </div>
            </div>
            <div class="p-4 rounded transition-all duration-300" data-binding-class="computed.previewClasses">
              <h3 class="font-bold mb-2">Preview Panel</h3>
              <p>This is how your content will look with the selected theme and font size.</p>
              <p class="mt-2">
                Current settings:
                <span data-binding-text="computed.themeText">light theme</span>,
                <span data-binding-text="computed.fontText">medium font</span>
              </p>
            </div>
          </div>
        </div>

        <!-- 6. Accordion Example -->
        <div class="bg-white rounded-lg shadow-md p-6 space-y-4">
          <h2 class="text-xl font-semibold text-gray-700">6. Simple Accordion</h2>
          <div data-controller="binding" data-binding-initial-state="{ openPanel: null }">
            <!-- Panel 1 -->
            <div class="border border-gray-200 rounded-lg mb-2">
              <button
                class="w-full px-4 py-3 text-left font-medium text-gray-800 hover:bg-gray-50 rounded-t-lg flex justify-between items-center"
                data-action="click->binding#updateState"
                data-binding-updater-param="state.openPanel = state.openPanel === 'panel1' ? null : 'panel1'"
                data-binding-class="{ 'bg-blue-50 border-b border-gray-200': state.openPanel === 'panel1' }"
              >
                <span>What is Stimulus?</span>
                <svg
                  class="w-5 h-5 transition-transform duration-200"
                  data-binding-class="{ 'rotate-180': state.openPanel === 'panel1' }"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
              </button>
              <div class="overflow-hidden transition-all duration-300" data-binding-class="{ 'hidden': state.openPanel !== 'panel1' }">
                <div class="p-4 text-gray-600">
                  Stimulus is a JavaScript framework with modest ambitions. It doesn't seek to take over your entire front-end—in fact, it's
                  not concerned with rendering HTML at all. Instead, it's designed to augment your HTML with just enough behavior to make it
                  shine.
                </div>
              </div>
            </div>

            <!-- Panel 2 -->
            <div class="border border-gray-200 rounded-lg mb-2">
              <button
                class="w-full px-4 py-3 text-left font-medium text-gray-800 hover:bg-gray-50 rounded-t-lg flex justify-between items-center"
                data-action="click->binding#updateState"
                data-binding-updater-param="state.openPanel = state.openPanel === 'panel2' ? null : 'panel2'"
                data-binding-class="{ 'bg-blue-50 border-b border-gray-200': state.openPanel === 'panel2' }"
              >
                <span>How does data binding work?</span>
                <svg
                  class="w-5 h-5 transition-transform duration-200"
                  data-binding-class="{ 'rotate-180': state.openPanel === 'panel2' }"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
              </button>
              <div class="overflow-hidden transition-all duration-300" data-binding-class="{ 'hidden': state.openPanel !== 'panel2' }">
                <div class="p-4 text-gray-600">
                  Data binding allows you to automatically sync your application state with the DOM. When state changes, the UI updates
                  automatically without manual DOM manipulation. This creates reactive interfaces with minimal code.
                </div>
              </div>
            </div>

            <!-- Panel 3 -->
            <div class="border border-gray-200 rounded-lg mb-2">
              <button
                class="w-full px-4 py-3 text-left font-medium text-gray-800 hover:bg-gray-50 rounded-t-lg flex justify-between items-center"
                data-action="click->binding#updateState"
                data-binding-updater-param="state.openPanel = state.openPanel === 'panel3' ? null : 'panel3'"
                data-binding-class="{ 'bg-blue-50 border-b border-gray-200': state.openPanel === 'panel3' }"
              >
                <span>Why use this approach?</span>
                <svg
                  class="w-5 h-5 transition-transform duration-200"
                  data-binding-class="{ 'rotate-180': state.openPanel === 'panel3' }"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
              </button>
              <div class="overflow-hidden transition-all duration-300" data-binding-class="{ 'hidden': state.openPanel !== 'panel3' }">
                <div class="p-4 text-gray-600">
                  This approach provides a clean separation between state and presentation. It's declarative, easy to understand, and
                  reduces the complexity of managing UI state. Plus, it works great with server-rendered HTML!
                </div>
              </div>
            </div>

            <!-- Status indicator -->
            <div class="mt-4 text-sm text-gray-500 text-center">
              Currently open:
              <span data-binding-text="state.openPanel || 'None'">None</span>
            </div>
          </div>
        </div>

        <!-- 7. Live Search Results Example -->
        <div class="bg-white rounded-lg shadow-md p-6 space-y-4">
          <h2 class="text-xl font-semibold text-gray-700">7. Live Search Results</h2>
          <div
            data-controller="binding"
            data-binding-initial-state="{ query: '', items: ['Apple', 'Banana', 'Cherry', 'Date', 'Elderberry', 'Fig', 'Grape'] }"
          >
            <!-- Computed Properties Templates -->
            <script type="text/template" data-binding-computed="hasQuery">
              state.query !== ''
            </script>
            <script type="text/template" data-binding-computed="filteredResults">
              state.items.filter(item => item.toLowerCase().includes(state.query.toLowerCase()))
            </script>
            <script type="text/template" data-binding-computed="resultCount">
              computed.filteredResults.length
            </script>
            <script type="text/template" data-binding-computed="resultsText">
              computed.hasQuery ? computed.resultCount + ' results found' : state.items.length + ' items available'
            </script>
            <script type="text/template" data-binding-computed="hasNoResults">
              computed.hasQuery && computed.resultCount === 0
            </script>
            <script type="text/template" data-binding-computed="itemsHtml">
              computed.filteredResults.map(item => `
                <div class="p-2 bg-gray-50 rounded border-l-4 ${computed.hasQuery ? 'border-blue-500' : 'border-gray-300'}">
                  ${item}
                </div>
              `).join('')
            </script>

            <input
              type="text"
              placeholder="Search fruits..."
              data-binding-value="state.query"
              data-action="input->binding#updateState"
              data-binding-updater-param="state.query = target.value"
              class="w-full p-3 border border-gray-300 rounded-lg mb-4"
            />

            <!-- Results counter -->
            <div class="text-sm text-gray-600 mb-2">
              <span data-binding-text="computed.resultsText">7 items available</span>
            </div>

            <!-- Results list -->
            <div class="space-y-2" data-binding-html="computed.itemsHtml"></div>

            <!-- No results message -->
            <div data-binding-show="computed.hasNoResults">
              <p class="text-center text-gray-500 mt-4">No results found for "<span data-binding-text="state.query"></span>"</p>
            </div>
          </div>
        </div>

        <!-- 8. Character Counter Example -->
        <div class="bg-white rounded-lg shadow-md p-6 space-y-4">
          <h2 class="text-xl font-semibold text-gray-700">8. Character Counter & Text Analysis</h2>
          <div data-controller="binding" data-binding-initial-state="{ text: '', maxLength: 280 }">
            <!-- Computed Properties Templates -->
            <script type="text/template" data-binding-computed="characterCount">
              state.text.length
            </script>
            <script type="text/template" data-binding-computed="wordCount">
              state.text.trim().split(/\s+/).filter(word => word.length > 0).length
            </script>
            <script type="text/template" data-binding-computed="lineCount">
              state.text.split('\n').length
            </script>
            <script type="text/template" data-binding-computed="readingTime">
              Math.ceil(computed.wordCount / 200)
            </script>
            <script type="text/template" data-binding-computed="usagePercentage">
              Math.round((computed.characterCount / state.maxLength) * 100)
            </script>
            <script type="text/template" data-binding-computed="isOverLimit">
              computed.characterCount > state.maxLength
            </script>
            <script type="text/template" data-binding-computed="isNearLimit">
              computed.characterCount > state.maxLength * 0.8 && computed.characterCount <= state.maxLength
            </script>
            <script type="text/template" data-binding-computed="isComfortable">
              computed.characterCount > 0 && computed.characterCount <= state.maxLength * 0.8
            </script>
            <script type="text/template" data-binding-computed="isEmpty">
              computed.characterCount === 0
            </script>
            <script type="text/template" data-binding-computed="isHalfway">
              computed.characterCount > 0 && computed.characterCount <= state.maxLength * 0.5
            </script>

            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700 mb-2">Max characters allowed</label>
              <input
                type="range"
                min="50"
                max="500"
                step="10"
                data-binding-value="state.maxLength"
                data-action="input->binding#updateState"
                data-binding-updater-param="state.maxLength = parseInt(target.value)"
                class="w-full"
              />
              <div class="text-center text-sm text-gray-600 mt-1" data-binding-text="state.maxLength + ' characters max'">
                280 characters max
              </div>
            </div>

            <div class="relative">
              <textarea
                placeholder="Start typing your message..."
                data-binding-value="state.text"
                data-action="input->binding#updateState"
                data-binding-updater-param="state.text = target.value"
                data-binding-class="{
                  'border-red-500 bg-red-50': computed.isOverLimit,
                  'border-yellow-500 bg-yellow-50': computed.isNearLimit,
                  'border-green-500 bg-green-50': computed.isComfortable
                }"
                class="w-full p-3 border border-gray-300 rounded-lg resize-none h-32 transition-colors"
              ></textarea>

              <!-- Character count overlay -->
              <div
                class="absolute bottom-3 right-3 px-2 py-1 rounded text-xs font-medium text-white"
                data-binding-class="{
                  'bg-red-600': computed.isOverLimit,
                  'bg-yellow-600': computed.isNearLimit,
                  'bg-green-600': computed.isComfortable,
                  'bg-gray-500': computed.isEmpty
                }"
                data-binding-text="computed.characterCount + '/' + state.maxLength"
              >
                0/280
              </div>
            </div>

            <!-- Text Statistics -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              <div class="bg-gray-50 p-3 rounded text-center">
                <div class="text-lg font-bold text-gray-800" data-binding-text="computed.characterCount">0</div>
                <div class="text-sm text-gray-600">Characters</div>
              </div>
              <div class="bg-gray-50 p-3 rounded text-center">
                <div class="text-lg font-bold text-gray-800" data-binding-text="computed.wordCount">0</div>
                <div class="text-sm text-gray-600">Words</div>
              </div>
              <div class="bg-gray-50 p-3 rounded text-center">
                <div class="text-lg font-bold text-gray-800" data-binding-text="computed.lineCount">1</div>
                <div class="text-sm text-gray-600">Lines</div>
              </div>
              <div class="bg-gray-50 p-3 rounded text-center">
                <div class="text-lg font-bold text-gray-800" data-binding-text="computed.readingTime">0</div>
                <div class="text-sm text-gray-600">Est. Reading (min)</div>
              </div>
            </div>

            <!-- Progress Bar -->
            <div class="mt-4">
              <div class="flex justify-between items-center mb-2">
                <span class="text-sm font-medium text-gray-700">Usage:</span>
                <span
                  class="text-sm font-bold"
                  data-binding-class="{
                    'text-red-600': computed.isOverLimit,
                    'text-yellow-600': computed.isNearLimit,
                    'text-green-600': !computed.isOverLimit && !computed.isNearLimit
                  }"
                  data-binding-text="computed.usagePercentage + '%'"
                >
                  0%
                </span>
              </div>
              <div class="w-full bg-gray-200 rounded-full h-3">
                <div
                  class="h-3 rounded-full transition-all duration-300"
                  data-binding-class="{
                    'bg-red-500': computed.isOverLimit,
                    'bg-yellow-500': computed.isNearLimit,
                    'bg-green-500': !computed.isOverLimit && !computed.isNearLimit
                  }"
                  data-binding-style="{ width: Math.min(100, computed.usagePercentage) + '%' }"
                ></div>
              </div>
            </div>

            <!-- Status Messages -->
            <div class="mt-4 space-y-2">
              <div
                class="text-sm p-2 rounded"
                data-binding-class="{
                  'hidden': !computed.isOverLimit,
                  'bg-red-100 text-red-700 border border-red-200': computed.isOverLimit
                }"
              >
                ⚠️ You've exceeded the character limit by
                <span data-binding-text="Math.max(0, computed.characterCount - state.maxLength)">0</span> characters
              </div>
              <div
                class="text-sm p-2 rounded"
                data-binding-class="{
                  'hidden': !computed.isNearLimit,
                  'bg-yellow-100 text-yellow-700 border border-yellow-200': computed.isNearLimit
                }"
              >
                ⚡ Approaching character limit - <span data-binding-text="state.maxLength - computed.characterCount">0</span> characters
                remaining
              </div>
              <div
                class="text-sm p-2 rounded"
                data-binding-class="{
                  'hidden': !computed.isHalfway,
                  'bg-green-100 text-green-700 border border-green-200': computed.isHalfway
                }"
              >
                ✅ Looking good! Plenty of room for more content
              </div>
            </div>
          </div>
        </div>

        <!-- 9. Terms and Conditions Example -->
        <div class="bg-white rounded-lg shadow-md p-6 space-y-4">
          <h2 class="text-xl font-semibold text-gray-700">9. Terms & Conditions Agreement</h2>
          <div data-controller="binding" data-binding-initial-state="{ acceptTerms: false, acceptPrivacy: false, email: '' }">
            <!-- Computed Properties Templates -->
            <script type="text/template" data-binding-computed="isValidEmail">
              state.email && state.email.includes('@') && state.email.length > 5
            </script>
            <script type="text/template" data-binding-computed="allRequirementsMet">
              state.acceptTerms && state.acceptPrivacy && computed.isValidEmail
            </script>
            <script type="text/template" data-binding-computed="requirementsCount">
              (state.acceptTerms ? 1 : 0) + (state.acceptPrivacy ? 1 : 0) + (computed.isValidEmail ? 1 : 0)
            </script>
            <script type="text/template" data-binding-computed="completionPercentage">
              Math.round((computed.requirementsCount / 3) * 100)
            </script>
            <script type="text/template" data-binding-computed="allRequirementsComplete">
              computed.requirementsCount === 3
            </script>

            <!-- Email Input -->
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
              <input
                type="email"
                placeholder="Enter your email address"
                data-binding-value="state.email"
                data-action="input->binding#updateState"
                data-binding-updater-param="state.email = target.value"
                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              />
            </div>

            <!-- Terms and Conditions Checkbox -->
            <div class="space-y-4">
              <label class="flex items-start space-x-3 cursor-pointer">
                <input
                  type="checkbox"
                  data-binding-checked="state.acceptTerms"
                  data-action="change->binding#updateState"
                  data-binding-updater-param="state.acceptTerms = target.checked"
                  class="mt-1 h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
                />
                <div class="text-sm">
                  <span class="text-gray-700">I agree to the </span>
                  <a href="#" class="text-blue-600 hover:text-blue-800 underline">Terms and Conditions</a>
                  <span class="text-gray-700"> and understand that my account will be subject to the platform rules and guidelines.</span>
                </div>
              </label>

              <!-- Privacy Policy Checkbox -->
              <label class="flex items-start space-x-3 cursor-pointer">
                <input
                  type="checkbox"
                  data-binding-checked="state.acceptPrivacy"
                  data-action="change->binding#updateState"
                  data-binding-updater-param="state.acceptPrivacy = target.checked"
                  class="mt-1 h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
                />
                <div class="text-sm">
                  <span class="text-gray-700">I have read and accept the </span>
                  <a href="#" class="text-blue-600 hover:text-blue-800 underline">Privacy Policy</a>
                  <span class="text-gray-700"> and consent to the collection and use of my personal data as described.</span>
                </div>
              </label>
            </div>

            <!-- Status Indicators -->
            <div class="mt-6 p-4 bg-gray-50 rounded-lg">
              <h3 class="text-sm font-medium text-gray-700 mb-3">Requirements Status:</h3>
              <div class="space-y-2 text-sm">
                <div class="flex items-center space-x-2">
                  <div
                    class="w-4 h-4 rounded-full flex items-center justify-center"
                    data-binding-class="{
                      'bg-green-500': computed.isValidEmail,
                      'bg-red-500': !computed.isValidEmail
                    }"
                  >
                    <span class="text-xs text-white font-bold" data-binding-text="computed.isValidEmail ? '✓' : '✗'">✗</span>
                  </div>
                  <span class="text-gray-600">Valid email address</span>
                </div>
                <div class="flex items-center space-x-2">
                  <div
                    class="w-4 h-4 rounded-full flex items-center justify-center"
                    data-binding-class="{
                      'bg-green-500': state.acceptTerms,
                      'bg-red-500': !state.acceptTerms
                    }"
                  >
                    <span class="text-xs text-white font-bold" data-binding-text="state.acceptTerms ? '✓' : '✗'">✗</span>
                  </div>
                  <span class="text-gray-600">Terms and Conditions accepted</span>
                </div>
                <div class="flex items-center space-x-2">
                  <div
                    class="w-4 h-4 rounded-full flex items-center justify-center"
                    data-binding-class="{
                      'bg-green-500': state.acceptPrivacy,
                      'bg-red-500': !state.acceptPrivacy
                    }"
                  >
                    <span class="text-xs text-white font-bold" data-binding-text="state.acceptPrivacy ? '✓' : '✗'">✗</span>
                  </div>
                  <span class="text-gray-600">Privacy Policy accepted</span>
                </div>
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex gap-3 mt-6">
              <button
                class="flex-1 py-3 px-6 rounded-lg font-medium transition-all duration-200"
                data-binding-class="{
                  'bg-blue-600 hover:bg-blue-700 text-white cursor-pointer': computed.allRequirementsMet,
                  'bg-gray-300 text-gray-500 cursor-not-allowed': !computed.allRequirementsMet
                }"
                data-binding-text="computed.allRequirementsMet ? 'Create Account' : 'Complete Requirements'"
              >
                Complete Requirements
              </button>
              <button class="px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">Cancel</button>
            </div>

            <!-- Progress Indicator -->
            <div class="mt-4">
              <div class="flex justify-between items-center mb-2">
                <span class="text-sm font-medium text-gray-700">Completion Progress:</span>
                <span
                  class="text-sm font-bold"
                  data-binding-class="{
                    'text-green-600': computed.allRequirementsComplete,
                    'text-blue-600': !computed.allRequirementsComplete
                  }"
                  data-binding-text="computed.completionPercentage + '%'"
                >
                  0%
                </span>
              </div>
              <div class="w-full bg-gray-200 rounded-full h-2">
                <div
                  class="h-2 rounded-full transition-all duration-300"
                  data-binding-class="{
                    'bg-green-500': computed.allRequirementsComplete,
                    'bg-blue-500': !computed.allRequirementsComplete
                  }"
                  data-binding-style="{ width: computed.completionPercentage + '%' }"
                ></div>
              </div>
            </div>

            <!-- Help Text -->
            <div class="mt-4 text-sm text-gray-600">
              <p data-binding-class="{ 'hidden': computed.allRequirementsMet }">
                Please complete all requirements above to create your account.
              </p>
              <p class="text-green-600 font-medium" data-binding-class="{ 'hidden': !computed.allRequirementsMet }">
                ✅ All requirements met! You can now create your account.
              </p>
            </div>
          </div>
        </div>

        <!-- 10. User Management Example -->
        <div class="bg-white rounded-lg shadow-md p-6 space-y-4">
          <h2 class="text-xl font-semibold text-gray-700">10. User Management (Advanced Filtering)</h2>
          <div
            data-controller="binding"
            data-binding-initial-state="{
              users: [
                { name: 'Alice', role: 'admin', active: true, score: 95 },
                { name: 'Bob', role: 'user', active: false, score: 78 },
                { name: 'Charlie', role: 'moderator', active: true, score: 88 },
                { name: 'Diana', role: 'user', active: true, score: 92 }
              ],
              filter: 'all',
              scoreFilter: 'all'
            }"
          >
            <!-- Computed Properties Templates -->
            <script type="text/template" data-binding-computed="classifyScore">
              (score) => {
                if (score >= 90) return { level: 'excellent', color: 'text-green-600', label: 'Excellent' };
                if (score >= 80) return { level: 'good', color: 'text-blue-600', label: 'Good' };
                return { level: 'needs-improvement', color: 'text-yellow-600', label: 'Needs Improvement' };
              }
            </script>
            <script type="text/template" data-binding-computed="filteredUsers">
              state.users.filter(user => {
                // Role filter
                const roleMatch = state.filter === 'all' ||
                  (state.filter === 'active' && user.active) ||
                  (state.filter === 'inactive' && !user.active) ||
                  (state.filter === 'admin' && user.role === 'admin');

                // Score filter
                const userScoreLevel = computed.classifyScore(user.score).level;
                const scoreMatch = state.scoreFilter === 'all' || state.scoreFilter === userScoreLevel;

                return roleMatch && scoreMatch;
              })
            </script>
            <script type="text/template" data-binding-computed="usersHtml">
              computed.filteredUsers.map(user => {
                const statusColor = user.active ? 'bg-green-500' : 'bg-red-500';
                const scoreInfo = computed.classifyScore(user.score);

                return `
                  <div class="flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50">
                    <div class="flex items-center space-x-3">
                      <div class="w-3 h-3 ${statusColor} rounded-full"></div>
                      <div>
                        <div class="font-medium">${user.name}</div>
                        <div class="text-sm text-gray-500 capitalize">${user.role}</div>
                      </div>
                    </div>
                    <div class="flex items-center space-x-4">
                      <div class="text-right">
                        <div class="text-sm font-medium">Score: ${user.score}</div>
                        <span class="text-xs ${scoreInfo.color} font-medium">${scoreInfo.label}</span>
                      </div>
                    </div>
                  </div>
                `;
              }).join('')
            </script>

            <!-- Controls -->
            <div class="flex gap-4 mb-4">
              <div class="flex-1">
                <label class="block text-sm font-medium text-gray-700 mb-2">Filter</label>
                <select
                  data-binding-value="state.filter"
                  data-action="change->binding#updateState"
                  data-binding-updater-param="state.filter = target.value"
                  class="w-full p-2 border border-gray-300 rounded"
                >
                  <option value="all">All Users</option>
                  <option value="active">Active Only</option>
                  <option value="inactive">Inactive Only</option>
                  <option value="admin">Admins Only</option>
                </select>
              </div>
              <div class="flex-1">
                <label class="block text-sm font-medium text-gray-700 mb-2">Score Filter</label>
                <select
                  data-binding-value="state.scoreFilter"
                  data-action="change->binding#updateState"
                  data-binding-updater-param="state.scoreFilter = target.value"
                  class="w-full p-2 border border-gray-300 rounded"
                >
                  <option value="all">All Scores</option>
                  <option value="excellent">Excellent (90+)</option>
                  <option value="good">Good (80-89)</option>
                  <option value="needs-improvement">Needs Improvement (&lt;80)</option>
                </select>
              </div>
            </div>

            <!-- No users message -->
            <div data-binding-show="computed.filteredUsers.length === 0" class="text-center py-8 text-gray-500">
              <p>No users match the current filters</p>
            </div>

            <!-- User List -->
            <div class="space-y-2" data-binding-html="computed.usersHtml"></div>
          </div>
        </div>
      </div>
    </div>

    <script type="module">
      import { Application, Controller } from "@hotwired/stimulus";

      class BindingController extends Controller {
        connect() {
          this.state = new Function(`return ${this.data.get("initial-state")}`)();
          this.computed = {};
          this.applyBindings();
        }

        updateState(event) {
          this.evaluateUpdate(event.params.updater, event.target);
          this.applyBindings();
        }

        applyBindings() {
          this.bindingElements("computed").forEach(this.applyComputedBinding.bind(this));
          this.bindingElements("text").forEach(this.applyTextBinding.bind(this));
          this.bindingElements("value").forEach(this.applyValueBinding.bind(this));
          this.bindingElements("class").forEach(this.applyClassBinding.bind(this));
          this.bindingElements("style").forEach(this.applyStyleBinding.bind(this));
          this.bindingElements("checked").forEach(this.applyCheckedBinding.bind(this));
          this.bindingElements("disabled").forEach(this.applyDisabledBinding.bind(this));
          this.bindingElements("show").forEach(this.applyShowBinding.bind(this));
          this.bindingElements("html").forEach(this.applyHtmlBinding.bind(this));
        }

        bindingElements(bindingName) {
          return this.element.querySelectorAll(`[data-binding-${bindingName}]`);
        }

        applyTextBinding(element) {
          element.textContent = this.evaluateExpression(element.dataset.bindingText);
        }

        applyValueBinding(element) {
          element.value = this.evaluateExpression(element.dataset.bindingValue);
        }

        applyClassBinding(element) {
          const classes = this.evaluateExpression(element.dataset.bindingClass);
          Object.keys(classes).forEach((classNames) => this.applyClass(element, classNames, classes[classNames]));
        }

        applyClass(element, classNames, isToggled) {
          classNames.split(" ").forEach((className) => element.classList.toggle(className.trim(), isToggled));
        }

        applyStyleBinding(element) {
          const styles = this.evaluateExpression(element.dataset.bindingStyle);

          Object.keys(styles).forEach((property) => {
            element.style[property] = styles[property];
          });
        }

        applyCheckedBinding(element) {
          element.checked = this.evaluateExpression(element.dataset.bindingChecked);
        }

        applyDisabledBinding(element) {
          element.disabled = this.evaluateExpression(element.dataset.bindingDisabled);
        }

        applyShowBinding(element) {
          const shouldShow = this.evaluateExpression(element.dataset.bindingShow);
          element.style.display = shouldShow ? "" : "none";
        }

        applyHtmlBinding(element) {
          element.innerHTML = this.evaluateExpression(element.dataset.bindingHtml);
        }

        applyComputedBinding(element) {
          const name = element.dataset.bindingComputed;
          const templateContent = element.textContent.trim();

          Object.defineProperty(this.computed, name, {
            get: () => this.evaluateExpression(templateContent),
            configurable: true,
          });
        }

        evaluateUpdate(updater, target) {
          this.state = new Function("state", "target", `${updater}; return state;`)(this.state, target);
        }

        evaluateExpression(expression) {
          return new Function("state", "computed", `return ${expression};`)(this.state, this.computed);
        }
      }

      const application = Application.start();
      application.register("binding", BindingController);
    </script>
  </body>
</html>
